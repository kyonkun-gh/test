# test

## SQL 四大指令分類
- **DDL（資料定義語言）**：CREATE, ALTER, DROP, TRUNCATE, RENAME, COMMENT
- **DML（資料操作語言）**：SELECT, INSERT, UPDATE, DELETE
- **DCL（資料控制語言）**：GRANT, REVOKE
- **TCL（交易控制語言）**：COMMIT, ROLLBACK, SAVEPOINT

## ANSI/SPARC 資料庫三層架構（Three-Schema Architecture）
### 這是描述資料庫系統的層次結構與抽象層級：
| 層級   | 名稱        | 說明                                   | 使用對象               |
|--------|-------------|----------------------------------------|------------------------|
| 外部層 | External    | 使用者視圖，每位使用者看到的子集合     | 使用者 / 開發者        |
| 概念層 | Conceptual  | 全企業邏輯結構，所有資料的整體模型     | 系統設計者             |
| 內部層 | Internal    | 資料實際儲存方式，例如索引與壓縮方式   | DBA（資料庫管理員）    |

## 資料庫設計三階段（Database Design Phases）
| 階段       | 名稱                         | 工具 / 方法                         | 對應三層架構      |
|------------|------------------------------|-------------------------------------|-------------------|
| 第 1 階段  | 概念設計（Conceptual Design） | ER 模型（Entity-Relationship）      | 對應「概念層」    |
| 第 2 階段  | 邏輯設計（Logical Design）    | 轉為關聯表、設計主鍵、外鍵等        | 部分對應「外部層」|
| 第 3 階段  | 實體設計（Physical Design）   | 選資料型別、建索引、效能優化等      | 對應「內部層」    |

## ER 模型屬性類型

| 屬性類型                        | 說明                     | 範例                   |
|----------------------------------|--------------------------|------------------------|
| 必要屬性 Required Attribute      | 不可為 NULL              | 姓名、學號             |
| 可選屬性 Optional Attribute      | 可為 NULL                | 傳真號碼、第二電話     |
| 單值屬性 Single-valued Attribute | 一筆資料對應一個值       | 性別、生日             |
| 多值屬性 Multi-valued Attribute  | 一筆資料可對應多個值     | 技能、電話號碼         |
| 組合屬性 Composite Attribute     | 可再拆分成多個欄位       | 地址 → 縣市 + 街道     |
| 簡單屬性 Atomic/Simple Attribute | 不可拆分                 | 姓名、郵遞區號         |
| 推論屬性 Derived Attribute       | 從其他欄位計算得出       | 年齡、工作年資         |
| 儲存屬性 Stored Attribute        | 真正存入資料庫的值       | 出生日期、薪資         |
| 識別/鍵屬性 Key Attribute        | 可唯一識別一筆記錄       | 學號、員工編號         |

## ER 模型個體型態
- **強個體型態**：可獨立存在，有主鍵
- **弱個體型態**：需依賴其他實體才能存在

## 鍵（Key）的類型
| 鍵類型                | 英文名稱         | 說明                                                                                  |
|-----------------------|------------------|---------------------------------------------------------------------------------------|
| 超鍵                  | Super Key        | 包含一組欄位，可以唯一識別資料表中的每筆資料，但可能包含多餘欄位（非最小鍵）。         |
| 候選鍵                | Candidate Key    | 具備唯一性的欄位或欄位組合，具有成為主鍵的資格。主鍵是從候選鍵中挑選出來的。           |
| 主鍵                  | Primary Key      | 唯一標識資料表中每一筆紀錄的欄位或欄位組合，不可為空值（NULL）。                       |
| 交替鍵                | Alternate Key    | 候選鍵中未被選為主鍵的其他候選鍵。                                                    |
| 組合鍵                | Composite Key    | 由多個欄位組成的鍵，用來唯一標識資料列。                                               |
| 外來鍵                | Foreign Key      | 在一個表中，用來參考另一表的主鍵，建立表間關聯並維護參考完整性。                       |
| 次鍵                  | Secondary Key    | 用於加速查詢的欄位索引，不一定唯一，不是用來唯一標識資料列。                           |
- **超鍵 > 候選鍵 = 主鍵+交替鍵**	

## 資料庫的完整性規則
1. **實體完整性規則（Entity Integrity Rule）**  
    在單一資料表中，主鍵（Primary Key）必須具有唯一性，且不可為空值（NULL）。

2. **參考完整性規則（Referential Integrity Rule）**  
    在兩個資料表中，次要資料表的外鍵（Foreign Key, FK）欄位值，必須存在於主要資料表的主鍵（Primary Key, PK）欄位值中。

3. **值域完整性規則（Domain Integrity Rule）**  
    在單一資料表中，同一資料行的屬性值必須符合預先定義的資料型別或範圍。

## ACID 四大交易特性
| 特性       | 英文名稱    | 說明                                   | 目的/效果                       |
|------------|-------------|----------------------------------------|----------------------------------|
| 原子性     | Atomicity   | 一筆交易要嘛全部完成，要嘛完全不做      | 防止交易一半成功                 |
| 一致性     | Consistency | 交易執行前後，資料要符合預設規則        | 確保資料合法性                   |
| 隔離性     | Isolation   | 多筆交易同時執行時，不互相干擾          | 避免交易交錯讀寫導致資料錯亂     |
| 持久性     | Durability  | 一旦交易完成，資料變更永久保存          | 防止資料因故障丟失               |

## 主要鎖定模式（Lock Modes）
| 鎖定類型             | 縮寫         | 說明                                                                                   |
|----------------------|--------------|----------------------------------------------------------------------------------------|
| 共用鎖               | S            | 用於讀取資料（如 SELECT），允許多個交易同時讀取，但不允許寫入。                        |
| 獨佔鎖               | X            | 用於寫入資料（如 INSERT、UPDATE、DELETE），只允許一個交易存取，其他交易無法讀寫。      |
| 更新鎖               | U            | 用於可能會更新資料的操作（例如讀完後再更新），避免死結，先取得更新鎖，再升級為獨佔鎖。|
| 意圖共用鎖           | IS           | 表示某個子物件（如列）有共用鎖，用於支援表級鎖與列級鎖之間的協調。                    |
| 意圖獨佔鎖           | IX           | 表示某個子物件有獨佔鎖，例如列被 X 鎖時，表層會加 IX 鎖。                             |
| 意圖更新鎖           | IU           | 表示有子物件正嘗試取得 U 鎖。                                                          |
| 架構鎖（Schema Lock）| Sch-S / Sch-M| 當執行 SELECT（Sch-S）或 ALTER TABLE（Sch-M）等資料結構操作時使用。                   |
| Bulk Update 鎖       | BU           | 用於大量資料匯入操作（如 BULK INSERT），允許快速載入資料。                             |

## 鎖定層級（Lock Granularity）
| 層級         | 說明                                                         |
|--------------|--------------------------------------------------------------|
| 資料列 (Row) | 最細的鎖定單位，並發性高但開銷大。                           |
| 資料頁 (Page)| 一頁 8KB，通常包含多筆資料列。                               |
| 資料表 (Table)| 對整張表加鎖，效率高但會造成阻塞。                           |
| 資料庫 (Database)| 很少用，除非執行大規模維護。                             |

## 正規化
| 正規化階段 | 要解決的問題           | 規則說明                                   |
|------------|------------------------|--------------------------------------------|
| 1NF        | 重複欄位（非原子值）   | 每個欄位都是不可再分的原子值               |
| 2NF        | 部分相依               | 非主鍵欄位必須完全依賴主鍵                 |
| 3NF        | 傳遞相依               | 非主鍵欄位不能依賴其他非主鍵欄位           |
| BCNF       | 候選鍵問題             | 所有決定欄位都必須是候選鍵                 |
